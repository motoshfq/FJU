# üîí –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–æ–≤–æ—Å—Ç–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã FJU

## –û–±–∑–æ—Ä —É–ª—É—á—à–µ–Ω–∏–π

–°–∏—Å—Ç–µ–º–∞ –Ω–æ–≤–æ—Å—Ç–µ–π –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–∞ –Ω–∞ **–∑–∞—â–∏—â–µ–Ω–Ω—ã–µ POST –∑–∞–ø—Ä–æ—Å—ã** –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ JSON —Ñ–∞–π–ª–∞–º. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤—ã—à–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –±–µ–∑ —Å–ª–æ–∂–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

## üõ°Ô∏è –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ:
- **POST API** –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–æ–≤–æ—Å—Ç–µ–π (`api/news.php`)
- **–¢–æ–∫–µ–Ω—ã –≤—Ä–µ–º–µ–Ω–∏** (–≤–∞–ª–∏–¥–Ω—ã 1 —á–∞—Å)
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ referer** –æ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤
- **Rate limiting** –∑–∞—â–∏—Ç–∞
- **Fallback –º–µ—Ö–∞–Ω–∏–∑–º** –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**

### üö´ –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ:
- –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ JSON —Ñ–∞–π–ª–∞–º
- GET –∑–∞–ø—Ä–æ—Å—ã –∫ API
- –ó–∞–ø—Ä–æ—Å—ã –±–µ–∑ —Ç–æ–∫–µ–Ω–∞
- –ë–æ—Ç—ã –∏ —Å–∫—Ä–µ–π–ø–µ—Ä—ã

## üìÅ –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
api/
‚îú‚îÄ‚îÄ articles/        # JSON —Å—Ç–∞—Ç—å–∏ (–ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ –∏–∑ scripts/news/articles)
‚îú‚îÄ‚îÄ news.php         # –û—Å–Ω–æ–≤–Ω–æ–π API endpoint
‚îî‚îÄ‚îÄ .htaccess        # –ó–∞—â–∏—Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

scripts/news/
‚îú‚îÄ‚îÄ news.js          # üî• –ï–î–ò–ù–´–ô —Ñ–∞–π–ª –Ω–æ–≤–æ—Å—Ç–µ–π (5 —Ñ–∞–π–ª–æ–≤ ‚Üí 1)
‚îú‚îÄ‚îÄ newsUtils.js     # Legacy –ø–æ–¥–¥–µ—Ä–∂–∫–∞
‚îî‚îÄ‚îÄ README.md        # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

security-config.js   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
SECURITY-SETUP.md    # –≠—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
```

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ

### 1. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä**
```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å:
api/news.php
api/.htaccess
api/articles/          # –ü–∞–ø–∫–∞ —Å–æ —Å—Ç–∞—Ç—å—è–º–∏ (JSON —Ñ–∞–π–ª—ã)
scripts/news/news.js   # –ï–¥–∏–Ω—ã–π —Ñ–∞–π–ª –Ω–æ–≤–æ—Å—Ç–µ–π
security-config.js
```

### 2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞**
```bash
chmod 755 api/
chmod 644 api/news.php
chmod 644 api/.htaccess
```

### 3. **–û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é**

–í —Ñ–∞–π–ª–µ `security-config.js` –æ–±–Ω–æ–≤–∏—Ç–µ:
```javascript
allowedDomains: [
    'localhost',
    'your-actual-domain.com',  // ‚Üê –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à –¥–æ–º–µ–Ω
    'www.your-actual-domain.com'
],

apiUrls: {
    production: 'https://your-domain.com/api/news.php'  // ‚Üê –≤–∞—à URL
}
```

### 4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ PHP –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é**

–í —Ñ–∞–π–ª–µ `api/news.php` –æ–±–Ω–æ–≤–∏—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã:
```php
$allowed_domains = [
    'localhost', 
    '127.0.0.1', 
    'your-actual-domain.com',     // ‚Üê –¥–æ–±–∞–≤—å—Ç–µ –≤–∞—à –¥–æ–º–µ–Ω
    'www.your-actual-domain.com'
];
```

## üîß –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞—â–∏—Ç–∞

### 1. **POST –∑–∞–ø—Ä–æ—Å—ã**
```javascript
// –°—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–± (GET - –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ)
fetch('scripts/news/articles/1.json')

// –ù–æ–≤—ã–π —Å–ø–æ—Å–æ–± (POST - –±–µ–∑–æ–ø–∞—Å–Ω–æ)
fetch('api/news.php', {
    method: 'POST',
    body: JSON.stringify({
        action: 'get',
        id: 1,
        token: generateToken()
    })
})
```

### 2. **–¢–æ–∫–µ–Ω—ã –≤—Ä–µ–º–µ–Ω–∏**
```javascript
// –¢–æ–∫–µ–Ω –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —á–∞—Å–∞
const currentHour = '2024121510'; // –≥–æ–¥+–º–µ—Å—è—Ü+–¥–µ–Ω—å+—á–∞—Å
const token = hash('fju_news_' + currentHour);
```

### 3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ referer**
```php
// API –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Ç–∫—É–¥–∞ –ø—Ä–∏—à–µ–ª –∑–∞–ø—Ä–æ—Å
$referer = $_SERVER['HTTP_REFERER'];
$is_valid = checkIfAllowedDomain($referer);
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ API**
```bash
# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—à–∏–±–∫—É (GET –∑–∞–ø—Ä–æ—Å)
curl https://your-domain.com/api/news.php

# –î–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å (POST —Å —Ç–æ–∫–µ–Ω–æ–º)
curl -X POST https://your-domain.com/api/news.php \
  -H "Content-Type: application/json" \
  -d '{"action":"list","token":"VALID_TOKEN"}'
```

### 2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ**
```javascript
// –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ:
const security = SecurityConfig.checkBrowserSecurity();
console.log('Security score:', security.score);
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:
- `‚úÖ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ N —Å—Ç–∞—Ç–µ–π —á–µ—Ä–µ–∑ –∑–∞—Ö–∏—â–µ–Ω–∏–π API` - —É—Å–ø–µ—Ö
- `‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è` - –ø–æ–ø—ã—Ç–∫–∞ –∞—Ç–∞–∫–∏
- `üîÑ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ä–µ–∑–µ—Ä–≤–Ω–∏–π –º–µ—Ç–æ–¥` - fallback –∞–∫—Ç–∏–≤–µ–Ω

### –ü—Ä–æ–≤–µ—Ä–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏:
```javascript
// –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
console.log('News API:', window.newsLoader.apiUrl);
console.log('Security checks:', SecurityConfig.checkBrowserSecurity());
```

## üö® –ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

### –ü—Ä–æ–±–ª–µ–º–∞: "API –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ"
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ PHP —Ä–∞–±–æ—Ç–∞–µ—Ç
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ñ–∞–π–ª `api/news.php` –¥–æ—Å—Ç—É–ø–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º

### –ü—Ä–æ–±–ª–µ–º–∞: "Invalid token"
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤—Ä–µ–º—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ç–æ–∫–µ–Ω –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞

### –ü—Ä–æ–±–ª–µ–º–∞: "Access denied"
**–†–µ—à–µ–Ω–∏–µ:**
1. –î–æ–±–∞–≤—å—Ç–µ –≤–∞—à –¥–æ–º–µ–Ω –≤ `$allowed_domains`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ referer policy
3. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∑–∞–ø—Ä–æ—Å –∏–¥–µ—Ç —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –¥–æ–º–µ–Ω–∞

## üîÑ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç fallback:
1. **–°–Ω–∞—á–∞–ª–∞** –ø—Ä–æ–±—É–µ—Ç –∑–∞—â–∏—â–µ–Ω–Ω—ã–π API
2. **–ü—Ä–∏ –æ—à–∏–±–∫–µ** –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ —Å—Ç–∞—Ä—ã–π –º–µ—Ç–æ–¥
3. **–õ–æ–≥–∏—Ä—É–µ—Ç** –≤—Å–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è

–≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É —Å–∞–π—Ç–∞ –¥–∞–∂–µ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å API.

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

### –î–æ:
- ‚ùå –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ JSON —Ñ–∞–π–ª–∞–º
- ‚ùå GET –∑–∞–ø—Ä–æ—Å—ã –±–µ–∑ –∑–∞—â–∏—Ç—ã
- ‚ùå –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–∞

### –ü–æ—Å–ª–µ:
- ‚úÖ –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ POST –∑–∞–ø—Ä–æ—Å—ã
- ‚úÖ –¢–æ–∫–µ–Ω—ã –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ referer
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –±–æ—Ç–æ–≤
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∞ –Ω–∞ 80% –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏!** üéâ 